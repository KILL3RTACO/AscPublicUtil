(function(){var a,b;b=function(a,b,c){return Math.min(Math.max(b,a),c)},a=function(){function a(a,b){this.__width=a,this.__height=b,this.__borderSize=1,this.__cellSize=20,this.__voidColor="#FFF",this.__inactiveBorderColor="#AAA",this.__borderColor="#000",this.__colors=[]}return a.SQUARE=0,a.CIRCLE=1,a.DIAMOND=2,a.TRIANGLE_UP=3,a.TRIANGLE_LEFT=4,a.TRIANGLE_RIGHT=5,a.TRIANGLE_DOWN=6,a.TRIANGLE_UP_EQ=7,a.TRIANGLE_LEFT_EQ=8,a.TRIANGLE_RIGHT_EQ=9,a.TRIANGLE_DOWN_EQ=10,a.TOP=0,a.LEFT=1,a.BOTTOM=2,a.RIGHT=3,a.prototype.setWidth=function(a){return this.__width=a,this.__updateSize()},a.prototype.getWidth=function(){return this.__width},a.prototype.setHeight=function(a){return this.__height=a,this.__updateSize()},a.prototype.getHeight=function(){return this.__height},a.prototype.__updateSize=function(){this.__ctx.canvas.width=this.getOffset(this.getWidth()),this.__ctx.canvas.height=this.getOffset(this.getHeight())},a.prototype.setVoidColor=function(a){return this.__voidColor=a,this},a.prototype.getVoidColor=function(){return this.__voidColor},a.prototype.setColorData=function(a){this.__colors=a},a.prototype.getColorData=function(){return this.__colors},a.prototype.getOffset=function(a){return(this.getCellSize()+this.getBorderSize())*a+this.getBorderSize()},a.prototype.getOffsetPoint=function(a,b){return{x:this.getOffset(a),y:this.getOffset(b)}},a.prototype.getCenter=function(a){return this.getOffset(a)+this.__cellSize/2},a.prototype.getCenterPoint=function(a,b){return{x:this.getCenter(a),y:this.getCenter(b)}},a.prototype.setCanvas=function(a){return this.__ctx=a.getContext("2d"),this.__updateSize(),this},a.prototype.getContext=function(){return this.__ctx},a.prototype.color=function(a,b,c){return this.colorRaw(a,b,this.__colors.getColor(c))},a.prototype.colorRaw=function(a,b,c){return this.__ctx.save(),this.__ctx.fillStyle=c,this.__ctx.fillRect(this.getOffset(a),this.getOffset(b),this.__cellSize,this.__cellSize),this.__ctx.restore()},a.prototype.colorBorder=function(a,b,c,d){return this.colorBorderRaw(a,b,this.__colors.getColor(c),d)},a.prototype.colorBorderRaw=function(a,b,c,d){var e,f,g,h;if(this.__ctx.save(),this.__ctx.fillStyle=c,d===this.constructor.TOP)this.__ctx.fillRect(this.getOffset(a)-this.__borderSize,this.getOffset(b)-this.__borderSize,this.__cellSize+2*this.__borderSize,this.__borderSize);else if(d===this.constructor.LEFT)this.__ctx.fillRect(this.getOffset(a)-this.__borderSize,this.getOffset(b)-this.__borderSize,this.__borderSize,this.__cellSize+2*this.__borderSize);else if(d===this.constructor.BOTTOM)this.__ctx.fillRect(this.getOffset(a)-this.__borderSize,this.getOffset(b)+this.__cellSize,this.__cellSize+2*this.__borderSize,this.__borderSize);else if(d===this.constructor.RIGHT)this.__ctx.fillRect(this.getOffset(a)+this.__cellSize,this.getOffset(b)-this.__borderSize,this.__borderSize,this.__cellSize+2*this.__borderSize);else for(h=[this.constructor.TOP,this.constructor.LEFT,this.constructor.RIGHT,this.constructor.BOTTOM],f=0,g=h.length;g>f;f++)e=h[f],this.colorBorderRaw(a,b,c,e);return this.__ctx.restore()},a.prototype.colorMarker=function(a,b,c,d){return this.colorMakerRaw(a,b,this.getColor(c),d)},a.prototype.colorMarkerRaw=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;return j=this.getOffset(a),k=this.getOffset(b),i=this.__cellSize/4,m=this.__cellSize/2,n=k+i,f=j+i,g=j+m,h=k+m,l=j+this.__cellSize-i,e=k+this.__cellSize-i,this.__ctx.save(),this.__ctx.fillStyle=c,o=d===this.constructor.TRIANGLE_UP_EQ||d===this.constructor.TRIANGLE_LEFT_EQ||d===this.constructor.TRIANGLE_RIGHT_EQ||d===this.constructor.TRIANGLE_DOWN_EQ,p=o?i/2:0,d===this.constructor.CIRCLE?(this.__ctx.beginPath(),this.__ctx.arc(g,h,i,0,2*Math.PI),this.__ctx.closePath(),this.__ctx.fill()):d===this.constructor.DIAMOND?(this.__ctx.beginPath(),this.__ctx.moveTo(f,h),this.__ctx.lineTo(g,n),this.__ctx.lineTo(l,h),this.__ctx.lineTo(g,e),this.__ctx.closePath(),this.__ctx.fill()):d===this.constructor.TRIANGLE_UP||d===this.constructor.TRIANGLE_UP_EQ?(this.__ctx.beginPath(),this.__ctx.moveTo(f,e-p),this.__ctx.lineTo(g,n+p),this.__ctx.lineTo(l,e-p),this.__ctx.closePath(),this.__ctx.fill()):d===this.constructor.TRIANGLE_LEFT||d===this.constructor.TRIANGLE_LEFT_EQ?(this.__ctx.beginPath(),this.__ctx.moveTo(f+p,h),this.__ctx.lineTo(l-p,n),this.__ctx.lineTo(l-p,e),this.__ctx.closePath(),this.__ctx.fill()):d===this.constructor.TRIANGLE_RIGHT||d===this.constructor.TRIANGLE_RIGHT_EQ?(this.__ctx.beginPath(),this.__ctx.moveTo(f+p,n),this.__ctx.lineTo(l-p,h),this.__ctx.lineTo(f+p,e),this.__ctx.closePath(),this.__ctx.fill()):d===this.constructor.TRIANGLE_DOWN||d===this.constructor.TRIANGLE_DOWN_EQ?(this.__ctx.beginPath(),this.__ctx.moveTo(f,n+p),this.__ctx.lineTo(l,n+p),this.__ctx.lineTo(g,e-p),this.__ctx.closePath(),this.__ctx.fill()):this.__ctx.fillRect(j+i,k+i,m,m),this.__ctx.restore()},a.prototype.setBorderSize=function(a){return this.__borderSize=Number.isInteger(a)&&a>0?a:1,this.__updateSize(),this},a.prototype.getBorderSize=function(){return this.__borderSize},a.prototype.setBorderColor=function(a){return this.__borderColor=a,this},a.prototype.getBorderColor=function(){return this.__borderColor},a.prototype.setCellSize=function(a){return this.__cellSize=Number.isInteger(a)&&a>0?a:1,this.__updateSize(),this},a.prototype.getCellSize=function(){return this.__cellSize},a.prototype.colorPath=function(a,b){return drawPathRaw(a,this.getColor(b))},a.prototype.colorPathRaw=function(a,b){var c,d,e,f,g,h;if(!(null===a||a.length<2)){for(this.__ctx.save(),this.__ctx.strokeStyle=b,this.__ctx.beginPath(),e=null,c=0,d=a.length;d>c;c++)f=a[c],g=f.x,h=f.y,null===e?(e=this.getCenterPoint(g,h),this.__ctx.moveTo(e.x,e.y)):(this.__ctx.lineTo(e.x,e.y),e=this.getCenterPoint(g,h));return this.__ctx.lineTo(e.x,e.y),this.__ctx.stroke(),this.__ctx.closePath(),this.__ctx.restore()}},a.prototype.getCellLocation=function(a,c){var d,e;return d=Math.floor(a/(this.__cellSize+this.__borderSize)),e=Math.floor(c/(this.__cellSize+this.__borderSize)),{x:b(0,d,this.__width-1),y:b(0,e,this.__height-1)}},a}(),"object"==typeof module&&"object"==typeof module.exports?module.exports=a:window.MapRenderer=a}).call(this);